<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Johnny Ji's Blog</title>
  <meta name="description" content="One of the hardest and most annoying things I find time and time again whenever I begin a new rails project is the inital setup and configurations of your de...">
  <link rel="stylesheet" href="http://johnnyji.me/css/main.css">
  <link rel="canonical" href="/rspec/2015/06/23/configuring-helpers-in-rspec.html">
  <link rel="alternate" type="application/rss+xml" title="Johnny Ji" href="/feed.xml"" />
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i|Open+Sans:600,400" rel="stylesheet">
</head>


  <body class="lite">

    <header class="header header-lite">
  <a class="header-title header-title-lite" href="http://johnnyji.me">JOHNNY JI</a>
  <div class="header-social-media">
    <a href="https://www.github.com/johnnyji" target="_blank" class="header-social-media-link github header-lite">
      <i class="fa fa-github header-lite"></i>
    </a>
    <a href="https://www.twitter.com/johnnyisji" target="_blank" class="header-social-media-link twitter header-lite">
      <i class="fa fa-twitter header-lite"></i>
    </a>
    <a href="https://www.linkedin.com/in/johnnyji" target="_blank" class="header-social-media-link linkedin header-lite">
      <i class="fa fa-linkedin header-lite"></i>
    </a>
    <a href="https://www.instagram.com/johnnyisji"" target="_blank" class="header-social-media-link instagram header-lite">
      <i class="fa fa-instagram header-lite"></i>
    </a>
  </div>
</header>
    

    <div class="page-container">
      <div class="single-post">
  <header class="single-post-header">
    <h1 class="single-post-header-title">Configuring Helpers in RSpec</h1>
    <p class="single-post-header-date">// Jun 23, 2015</p>
  </header>
  <div class="single-post-content"><p>One of the hardest and most annoying things I find time and time again whenever I begin a new rails project is the inital setup and configurations of your development environment. Recently I began a new project where I was using Rails as an API, and I wanted to configure my RSpec to use helpers so my tests could stay DRY.</p>

<p>Configuring RSpec is not something I commit to memory, therefore I was spending some time online researching on how to do so, and the problem with online resources is that a lot of them are outdated or just simply don’t work. So after struggling for a bit on something that seemed so intuitive, I decided to document it here on my blog; so that I’ll have a direct reference for the next time I need to set up helpers for RSpec.</p>

<p>So here goes…</p>

<p>After the inital setup with <code class="highlighter-rouge">rspec-rails</code> and running all the generators, the first thing is to include a <code class="highlighter-rouge">helpers</code> folder in your spec. The path should look like <code class="highlighter-rouge">app/spec/helpers</code></p>

<p>After doing that. Head into your <code class="highlighter-rouge">rails_helper</code> generated by <code class="highlighter-rouge">rspec-rails</code> and uncomment or add this line of code:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Dir</span><span class="p">[</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'spec/helpers/**/*.rb'</span><span class="p">)].</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="nb">require</span> <span class="n">f</span> <span class="p">}</span></code></pre></figure>

<p><br /></p>

<p>This will include all the files in your <code class="highlighter-rouge">helpers</code> folder. Now in your helpers folder you can add any helpers you. An example of one I use quite often is:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># app/spec/helpers.response_helpers.rb</span>

<span class="k">module</span> <span class="nn">ResponseHelpers</span>

  <span class="k">def</span> <span class="nf">parsed_body</span>
    <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
  <span class="k">end</span> 

  <span class="k">def</span> <span class="nf">expect_response_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">code</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">include</span> <span class="no">ResponseHelpers</span>
<span class="k">end</span></code></pre></figure>

<p><br /></p>

<p>This allows me to test the JSON response and response status quite easily, and I test these two things quite often as I’m fond of request specs; so it made sense to move these into their helpers. Now in order to use your helpers, all you would have to do is include <code class="highlighter-rouge">rails_helper</code> at the top of every spec file:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># app/spec/requests/...</span>

<span class="nb">require</span> <span class="s2">"rails_helper"</span>

<span class="n">describe</span> <span class="s2">"GET /some_path"</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s2">"returns 201 when succesful"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s2">"/some_path"</span>
    <span class="n">expect_response_code</span><span class="p">(</span><span class="s2">"201"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># =&gt; 1 example, 1 success</span></code></pre></figure>
</div>
</div>

    </div>

  </body>

</html>